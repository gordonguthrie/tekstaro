version: 2.1

orbs:
  docker: circleci/docker@1.0.1

jobs:
  publish_dev_container:
    - docker/publish:
        dockerfile: docker/tekstaro.dockerfile
        image: iocarney/tekstaro_dev
        path: ./

  public_aws_container:
    - docker/publish:
        dockerfile: docker/aws.dockerfile
        image: iocarney/tekstaro_aws
        path: ./

workflows:
  build_and_push:
    jobs:
      publish_dev_container
      - publish_aws_container
          requires:
            publish_dev_container
